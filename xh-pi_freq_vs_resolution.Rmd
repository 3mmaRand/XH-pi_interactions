---
title: "XH-pi frequency vs resolution"
author: "Emma Rand"
date: "22/08/2019"
output:
  pdf_document: bookdown::pdf_document2
  html_document: bookdown::html_document2
  word_document: default
bibliography: ref.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      message = FALSE)
```

```{r pkgs}
library(tidyverse)
library(data.table)
library(viridis)
library(MASS)
```

```{r}
# Get density of points in 2 dimensions.
# @param x A numeric vector.
# @param y A numeric vector.
# @param n Create a square n by n grid to compute density.
# @return The density within each square.
get_density <- function(x, y, ...) {
  dens <- MASS::kde2d(x, y, ...)
  ix <- findInterval(x, dens$x)
  iy <- findInterval(y, dens$y)
  ii <- cbind(ix, iy)
  return(dens$z[ii])
}

```


```{r}
file <- "../xhpi_data_new/xhpi_freq_res.csv"
resfreq <- read.csv(file)

glimpse(resfreq)
```

```{r}
ggplot(data = resfreq, aes(x = Resolution, y = freq)) +
  geom_point()
```


```{r}
resfreq$density <- get_density(resfreq$Resolution, resfreq$freq_per_100, n = 100)
ggplot(data = resfreq, aes(x = Resolution, y = freq_per_100, colour = density)) +
  geom_point() +
  scale_color_viridis()
```